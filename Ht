


import os
import pandas as pd

def traverse_jcl_directory(jcl_directory):
    all_jcl_results = []

    # Traverse the directory with JCL files
    for root, _, files in os.walk(jcl_directory):
        for file_name in files:
            if file_name.endswith('.jcl'):  # Process only JCL files
                job_name = extract_job_and_proc_name(file_name)[0]  # Assuming the first match is the job name
                file_path = os.path.join(root, file_name)

                with open(file_path, 'r') as jcl_file:
                    content = jcl_file.read()

                    # Parsing the content of each JCL file
                    jcl_results = parse_jcl_content(content)

                    for result in jcl_results:
                        all_jcl_results.append({
                            'job_name': job_name,
                            'program_name_inside_job': result['program_name_inside_proc'],  # Adjust key based on your parse_jcl_content implementation
                            'dsn_file_name': result['dsn_file_name'],
                            'disp_value': result['disp_value']
                        })

    # Convert the results into a DataFrame for better presentation and further analysis
    df = pd.DataFrame(all_jcl_results)
    return df

# Make sure the jcl_directory variable points to the actual path where your JCL files are stored
jcl_directory = "/path/to/your/jcl/files"
jcl_df = traverse_jcl_directory(jcl_directory)

# Display the DataFrame to verify the results
print(jcl_df)
